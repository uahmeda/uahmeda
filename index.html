<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>У Ахмеда</title>
    <link rel="icon" type="image/png" href="img/img/favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== ЗАГРУЗОЧНЫЙ ЭКРАН ========== */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }
        .loading-gif {
            width: 200px;
            height: 200px;
            object-fit: contain;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        /* Анимация гравитации для футера */
        @keyframes gravity {
            0% { transform: translate(0, 0) rotate(0deg); }
            20% { transform: translate(calc(var(--x) * 1px), calc(var(--y) * 1px)) rotate(calc(var(--r) * 1deg)); }
            40% { transform: translate(calc(var(--x2) * 1px), calc(var(--y2) * 1px)) rotate(calc(var(--r2) * 1deg)); }
            60% { transform: translate(calc(var(--x3) * 1px), calc(var(--y3) * 1px)) rotate(calc(var(--r3) * 1deg)); }
            80% { transform: translate(calc(var(--x4) * 1px), calc(var(--y4) * 1px)) rotate(calc(var(--r4) * 1deg)); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        .gravity-active {
            animation: gravity 2s ease-in-out forwards;
        }

        /* Анимация падения ахмедиков */
        @keyframes fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .ahmedik-fall {
            position: fixed;
            width: 40px;
            height: 40px;
            pointer-events: none;
            z-index: 9999;
            animation: fall 2s linear forwards;
            filter: drop-shadow(0 0 10px var(--main-color));
        }

        /* ========== ОСНОВНЫЕ СТИЛИ ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.3s ease;
        }

        :root {
            --main-color: #fccd97;
            --dark-color: #5c3d1e;
            --light-color: #fff9f0;
            --text-color: #333;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --handwritten-font: 'Caveat', cursive;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.6);
            --glass-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        body {
            background-color: #fefefe;
            color: var(--text-color);
            line-height: 1.6;
            padding-bottom: 90px;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ========== ШАПКА С ЛОГОТИПОМ ПО ЦЕНТРУ ========== */
        header {
            background-color: var(--main-color);
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .header-content {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-image {
            height: 80px;
            width: auto;
            background-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .logo-image:hover {
            transform: scale(1.05) rotate(2deg);
        }

        .logo-image img {
            height: 100%;
            width: auto;
            max-width: 100%;
            object-fit: contain;
            display: block;
            border-radius: 10px;
        }

        /* ========== СТИЛИ ФОРМ ========== */
        .form-group {
            margin-bottom: 20px;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 1rem;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .form-group:hover label {
            color: #7a4f29;
            transform: translateX(5px);
        }

        .form-control {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background-color: white;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--main-color);
            box-shadow: 0 0 0 4px rgba(252, 205, 151, 0.2), inset 0 2px 4px rgba(0,0,0,0.02);
            transform: translateY(-2px);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .submit-btn, .submit-order, .order-btn {
            background-color: var(--dark-color);
            color: white;
            border: none;
            padding: 16px 28px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
            box-shadow: 0 4px 12px rgba(92, 61, 30, 0.2);
            position: relative;
            overflow: hidden;
        }

        .submit-btn::after, .submit-order::after, .order-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .submit-btn:hover::after, .submit-order:hover::after, .order-btn:hover::after {
            width: 300px;
            height: 300px;
        }

        .submit-btn:hover, .submit-order:hover, .order-btn:hover:not(:disabled) {
            background-color: #7a4f29;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(92, 61, 30, 0.3);
        }

        .submit-btn:active, .submit-order:active, .order-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .order-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.6;
        }

        /* Стили для радио-кнопок доставки */
        .delivery-options {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .delivery-option {
            flex: 1;
        }

        .delivery-option input[type="radio"] {
            display: none;
        }

        .delivery-option label {
            display: block;
            padding: 14px 12px;
            background-color: #f8f8f8;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            text-align: center;
            font-weight: 600;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .delivery-option label::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(252, 205, 151, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }

        .delivery-option label:hover::before {
            width: 300px;
            height: 300px;
        }

        .delivery-option input[type="radio"]:checked + label {
            background-color: var(--main-color);
            border-color: var(--dark-color);
            color: var(--dark-color);
            box-shadow: 0 4px 10px rgba(252, 205, 151, 0.3);
            animation: bounce 0.3s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .delivery-address-group {
            display: none;
            animation: slideDown 0.3s ease;
        }

        .delivery-address-group.visible {
            display: block;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Кнопка-карточка бонусной карты (БЕЗ ЧЕКБОКСА) */
        .bonus-card-button {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px;
            background-color: #f8f8f8;
            border-radius: 16px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0 10px;
            position: relative;
            overflow: hidden;
        }

        .bonus-card-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s ease;
        }

        .bonus-card-button:hover::before {
            left: 100%;
        }

        .bonus-card-button:hover {
            background-color: #f0f0f0;
            border-color: var(--main-color);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .bonus-card-button.active {
            background-color: var(--main-color);
            border-color: var(--dark-color);
            box-shadow: 0 4px 12px rgba(252, 205, 151, 0.4);
            animation: pulse 0.5s ease;
        }

        .bonus-card-image {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border-radius: 10px;
            transition: transform 0.3s ease;
        }

        .bonus-card-button:hover .bonus-card-image {
            transform: rotate(5deg) scale(1.1);
        }

        .bonus-card-text {
            flex-grow: 1;
        }

        .bonus-card-text h4 {
            color: var(--dark-color);
            margin-bottom: 5px;
            font-size: 1.1rem;
            font-weight: 700;
            transition: color 0.3s ease;
        }

        .bonus-card-text p {
            color: #666;
            font-size: 0.9rem;
            margin: 0;
        }

        /* Чекбокс скрыт */
        .bonus-card-checkbox {
            display: none;
        }

        .bonus-balance-info {
            font-size: 0.95rem;
            color: var(--dark-color);
            margin: 10px 0 5px 75px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            animation: fadeIn 0.5s ease;
        }

        .bonus-warning {
            font-size: 0.9rem;
            color: #d32f2f;
            margin-left: 75px;
            background-color: #ffebee;
            padding: 8px 15px;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* ========== СТРАНИЦЫ (VIEWS) ========== */
        .page {
            display: none;
            animation: pageFade 0.5s ease;
        }
        .page.active {
            display: block;
        }
        @keyframes pageFade {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ========== НИЖНЕЕ НАВИГАЦИОННОЕ МЕНЮ - С ПЛАШКОЙ ========== */
        .bottom-nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            max-width: 500px;
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 8px 10px;
            box-shadow: var(--glass-shadow), 0 0 0 1px var(--glass-border) inset;
            z-index: 1000;
            border-radius: 40px;
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
        }

        .bottom-nav:hover {
            transform: translateX(-50%) scale(1.02);
            box-shadow: 0 15px 40px rgba(92, 61, 30, 0.3), 0 0 0 2px var(--main-color) inset;
            background: rgba(255, 255, 255, 0.8);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            font-size: 0.8rem;
            color: rgba(92, 61, 30, 0.7);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            padding: 8px 16px;
            border-radius: 30px;
            flex: 1;
            max-width: 100px;
            position: relative;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
            overflow: hidden;
            z-index: 2;
        }

        /* Плавающая плашка */
        .nav-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--main-color), #f5b56c);
            border-radius: 30px;
            z-index: -1;
            box-shadow: 0 4px 15px rgba(252, 205, 151, 0.5);
            animation: slideIn 0.3s ease, glow 2s ease-in-out infinite;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 4px 15px rgba(252, 205, 151, 0.5); }
            50% { box-shadow: 0 8px 25px rgba(252, 205, 151, 0.8); }
        }

        .nav-item i {
            font-size: 1.5rem;
            margin-bottom: 3px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .nav-item span {
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .nav-item.active {
            color: var(--dark-color);
            font-weight: 600;
        }

        .nav-item.active i {
            color: var(--dark-color);
            transform: scale(1.1);
            animation: iconWiggle 3s ease-in-out infinite;
        }

        @keyframes iconWiggle {
            0%, 100% { transform: rotate(0deg) scale(1.1); }
            25% { transform: rotate(5deg) scale(1.1); }
            75% { transform: rotate(-5deg) scale(1.1); }
        }

        .nav-item .cart-count-badge {
            position: absolute;
            top: -5px;
            right: 5px;
            background-color: var(--dark-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            border: 2px solid white;
            animation: badgePulse 1.5s ease-in-out infinite;
            z-index: 3;
        }

        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* ========== КАРУСЕЛЬ ========== */
        .banner-carousel {
            width: 100%;
            position: relative;
            overflow: hidden;
            background-color: white;
            height: 50vh;
            min-height: 300px;
            max-height: 500px;
            margin: 0 0 40px 0;
        }
        .carousel-container { width: 100%; height: 100%; position: relative; display: flex; overflow: hidden; }
        .carousel-track { display: flex; height: 100%; transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .carousel-slide { min-width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .carousel-slide img { 
            width: 100%; 
            height: 100%; 
            object-fit: contain; 
            display: block; 
            cursor: pointer;
            transition: transform 0.5s ease;
        }
        .carousel-slide img:hover {
            transform: scale(1.05);
        }

        /* ========== КОНТЕНТНЫЕ БЛОКИ ========== */
        .about-section, .features-section, .reviews-section, .menu-header, .contact-section {
            margin-bottom: 40px;
        }
        .about-section {
            background-color: var(--main-color);
            padding: 40px 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .about-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        .about-section h2 {
            color: var(--dark-color);
            margin-bottom: 20px;
            text-align: center;
            font-size: 2.5rem;
            font-family: var(--handwritten-font);
            font-weight: 700;
        }
        .about-section p {
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }
        .features-section h2 {
            color: var(--dark-color);
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5rem;
            font-family: var(--handwritten-font);
            font-weight: 700;
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
        }
        .feature-card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        .feature-icon { 
            font-size: 2.5rem; 
            color: var(--dark-color); 
            margin-bottom: 15px;
            transition: transform 0.3s ease;
        }
        .feature-card:hover .feature-icon {
            transform: scale(1.2) rotate(5deg);
        }
        .reviews-section h2 {
            color: var(--dark-color);
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5rem;
            font-family: var(--handwritten-font);
            font-weight: 700;
        }
        .reviews-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }
        .review-card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        .review-card:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .review-name { font-weight: 700; color: var(--dark-color); font-size: 1.1rem; }
        .review-rating { color: #ffc107; font-size: 1.1rem; }
        .bad-review { border: 2px solid #ff6b6b; background-color: #fff5f5; }

        /* ========== МЕНЮ ========== */
        .menu-header {
            text-align: center;
        }
        .menu-header h2 {
            color: var(--dark-color);
            font-size: 3rem;
            margin-bottom: 15px;
            font-family: var(--handwritten-font);
            font-weight: 700;
        }
        .categories {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .category-btn {
            background-color: white;
            border: 2px solid var(--main-color);
            color: var(--dark-color);
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .category-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(252, 205, 151, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }
        .category-btn:hover::before {
            width: 200px;
            height: 200px;
        }
        .category-btn:hover { 
            background-color: var(--main-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(252, 205, 151, 0.4);
        }
        .category-btn.active { 
            background-color: var(--main-color); 
            transform: scale(1.05);
            animation: activeCategory 0.3s ease;
        }
        @keyframes activeCategory {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }
        .menu-section { display: none; animation: fadeIn 0.5s ease; }
        .menu-section.active { display: block; }
        .section-title {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark-color);
            font-size: 2.2rem;
            font-family: var(--handwritten-font);
            font-weight: 700;
        }
        .section-title:after {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background-color: var(--main-color);
            margin: 10px auto;
            transition: width 0.3s ease;
        }
        .section-title:hover:after {
            width: 150px;
        }
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        .menu-item {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
            animation: fadeInUp 0.5s ease;
            animation-fill-mode: both;
        }
        .menu-item:nth-child(1) { animation-delay: 0.1s; }
        .menu-item:nth-child(2) { animation-delay: 0.2s; }
        .menu-item:nth-child(3) { animation-delay: 0.3s; }
        .menu-item:nth-child(4) { animation-delay: 0.4s; }
        .menu-item:nth-child(5) { animation-delay: 0.5s; }
        .menu-item:nth-child(6) { animation-delay: 0.6s; }

        .menu-item:hover { 
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        .item-image {
            height: 200px;
            overflow: hidden;
            background-color: var(--main-color);
            position: relative;
        }
        .item-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }
        .menu-item:hover .item-image::after {
            left: 100%;
        }
        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .menu-item:hover .item-image img { transform: scale(1.1); }
        .item-info { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
        .item-name { font-size: 1.3rem; font-weight: 700; margin-bottom: 10px; color: var(--dark-color); }
        .item-description { color: #666; margin-bottom: 15px; font-size: 0.95rem; flex-grow: 1; }
        .item-footer { display: flex; justify-content: space-between; align-items: center; margin-top: auto; }
        .item-price { font-size: 1.3rem; font-weight: 700; color: var(--dark-color); }
        .add-to-cart {
            background-color: var(--main-color);
            color: var(--dark-color);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .add-to-cart::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }
        .add-to-cart:hover::before {
            width: 100px;
            height: 100px;
        }
        .add-to-cart:hover { 
            background-color: #f5bf7d; 
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 15px rgba(252, 205, 151, 0.4);
        }

        /* ========== СТРАНИЦА КОРЗИНЫ (С ОТСТУПАМИ) ========== */
        .cart-page-content { 
            padding: 20px; 
        }
        .cart-page-items { 
            padding: 10px 0; 
        }
        .cart-page-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            border-radius: 12px;
            border: 1px solid #eee;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .cart-page-item:hover {
            background-color: #f5f5f5;
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .cart-page-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            border-top: 2px solid var(--main-color);
            border-bottom: 2px solid var(--main-color);
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-color);
            background-color: #fff9f0;
            border-radius: 12px;
            animation: fadeIn 0.5s ease;
        }
        .empty-cart-message {
            text-align: center;
            padding: 50px 20px;
            color: #666;
            font-size: 1.2rem;
            background-color: #f9f9f9;
            border-radius: 16px;
            margin: 20px 0;
            animation: fadeIn 0.5s ease;
        }

        /* ========== ОКНО "ЕЩЁ" ========== */
        .more-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .more-overlay.active { opacity: 1; visibility: visible; }
        .more-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 90vh;
            max-height: 90vh;
            background-color: white;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
            z-index: 2001;
            transform: translateY(100%);
            transition: transform 0.4s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .more-panel.active { transform: translateY(0); }
        .more-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--main-color);
            border-bottom: 2px solid var(--dark-color);
            min-height: 65px;
        }
        .more-back-btn {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--dark-color);
            padding: 5px 10px 5px 5px;
            margin-right: 10px;
            display: none;
            transition: transform 0.3s ease;
        }
        .more-back-btn:hover {
            transform: translateX(-5px);
        }
        .more-back-btn.visible { display: inline-block; }
        .more-header h2 {
            color: var(--dark-color);
            font-size: 2rem;
            font-family: var(--handwritten-font);
            font-weight: 700;
            margin: 0;
            flex-grow: 1;
        }
        .close-more {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--dark-color);
            padding: 5px;
            line-height: 1;
            transition: transform 0.3s ease;
        }
        .close-more:hover {
            transform: rotate(90deg);
        }
        .more-content { 
            flex: 1; 
            overflow-y: auto; 
            padding: 20px; 
        }

        /* Главное меню окна "Ещё" */
        .more-main-menu { display: block; }
        .more-main-menu.hidden { display: none; }
        .more-menu-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
        }
        .more-menu-item:hover { 
            background-color: var(--main-color);
            transform: translateX(5px) scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .more-menu-item i { 
            font-size: 1.8rem; 
            color: var(--dark-color); 
            width: 40px; 
            text-align: center;
            transition: transform 0.3s ease;
        }
        .more-menu-item:hover i {
            transform: scale(1.2) rotate(5deg);
        }
        .more-menu-item span { 
            font-size: 1.3rem; 
            font-weight: 600; 
            color: var(--dark-color);
            transition: transform 0.3s ease;
        }

        /* Контентные панели внутри "Ещё" */
        .more-content-panel { display: none; }
        .more-content-panel.active { display: block; }

        /* Бонусная карта внутри "Ещё" */
        .bonus-image-container { text-align: center; margin: 20px 0; }
        .bonus-image { 
            width: 200px; 
            height: 200px; 
            object-fit: contain; 
            border-radius: 10px; 
            margin: 0 auto; 
            display: block;
            transition: transform 0.3s ease;
        }
        .bonus-image:hover {
            transform: scale(1.05) rotate(2deg);
        }
        .bonus-balance-container {
            position: relative;
            background-color: var(--main-color);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 25px;
            margin-top: 20px;
            overflow: hidden;
            min-height: 160px;
            transition: all 0.3s ease;
        }
        .bonus-balance-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .bonus-balance-container .ahmedik-img {
            position: absolute;
            width: 40px;
            height: 40px;
            object-fit: contain;
            z-index: 1;
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        .bonus-balance-container:hover .ahmedik-img {
            opacity: 1;
            transform: rotate(10deg);
        }
        .bonus-balance { position: relative; z-index: 2; }
        .bonus-card-number {
            font-size: 0.95rem;
            color: var(--dark-color);
            margin-bottom: 10px;
            font-weight: 600;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 6px 15px;
            border-radius: 30px;
            display: inline-block;
        }
        .bonus-balance h3 { color: var(--dark-color); margin-bottom: 5px; font-family: var(--handwritten-font); font-size: 1.5rem; }
        .bonus-balance-value { 
            font-size: 2rem; 
            font-weight: 700; 
            color: var(--dark-color); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 5px; 
        }
        .bonus-currency { font-size: 1rem; color: #666; }
        .bonus-description { text-align: center; margin-bottom: 25px; font-size: 1rem; line-height: 1.5; color: #555; }
        .bonus-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--main-color);
            padding-bottom: 15px;
        }
        .bonus-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            background-color: #f5f5f5;
            border-radius: 30px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--dark-color);
        }
        .bonus-tab:hover {
            background-color: #e0e0e0;
            transform: translateY(-2px);
        }
        .bonus-tab.active {
            background-color: var(--main-color);
            border-color: var(--dark-color);
            animation: activeTab 0.3s ease;
        }
        @keyframes activeTab {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .bonus-tab-content {
            display: none;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 12px;
            margin-bottom: 20px;
            line-height: 1.6;
            animation: fadeIn 0.5s ease;
        }
        .bonus-tab-content.active { display: block; }
        .bonus-form {
            background-color: #f9f9f9;
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 20px;
            animation: slideUp 0.5s ease;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .bonus-form.hidden { display: none; }

        /* Заказы внутри "Ещё" */
        .orders-container { padding: 10px 0; }
        .order-card {
            background-color: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            border: 1px solid #f0f0f0;
            transition: all 0.3s ease;
            animation: fadeInUp 0.5s ease;
            animation-fill-mode: both;
        }
        .order-card:nth-child(1) { animation-delay: 0.1s; }
        .order-card:nth-child(2) { animation-delay: 0.2s; }
        .order-card:nth-child(3) { animation-delay: 0.3s; }
        .order-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        .order-card.completed { background-color: #f9f9f9; opacity: 0.9; }
        .order-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .order-number { font-weight: 700; color: var(--dark-color); font-size: 1.1rem; }
        .order-date { color: #666; font-size: 0.85rem; }
        .order-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        .status-ordered { background-color: #fff3cd; color: #856404; }
        .status-cooking { background-color: #d1ecf1; color: #0c5460; }
        .status-delivery { background-color: #d4edda; color: #155724; }
        .status-ready { background-color: #cce5ff; color: #004085; }
        .status-completed { background-color: #e2e3e5; color: #383d41; }
        .order-items { margin-bottom: 10px; }
        .order-item { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 5px; 
            font-size: 0.95rem;
            transition: background-color 0.3s ease;
        }
        .order-item:hover {
            background-color: #f0f0f0;
            border-radius: 4px;
        }
        .order-footer { display: flex; justify-content: space-between; align-items: center; padding-top: 10px; border-top: 1px solid #eee; }
        .order-total { font-size: 1.1rem; font-weight: 700; color: var(--dark-color); }
        .qr-code-container.show { 
            text-align: center; 
            margin-top: 15px;
            animation: fadeIn 0.5s ease;
        }
        .qr-code-image { 
            width: 120px; 
            height: 120px; 
            object-fit: contain; 
            border-radius: 10px;
            transition: transform 0.3s ease;
        }
        .qr-code-image:hover {
            transform: scale(1.1);
        }
        
        /* ========== КРАСИВАЯ КНОПКА ОЦЕНКИ ========== */
        .received-btn {
            background: linear-gradient(135deg, var(--dark-color) 0%, #7a4f29 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            margin-top: 20px;
            width: 100%;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 6px 15px rgba(92, 61, 30, 0.3);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .received-btn:hover {
            background: linear-gradient(135deg, #7a4f29 0%, #5c3d1e 100%);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 25px rgba(92, 61, 30, 0.4);
            border-color: var(--main-color);
        }
        
        .received-btn:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 3px 10px rgba(92, 61, 30, 0.3);
        }
        
        .received-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }
        
        .received-btn:hover::before {
            left: 100%;
        }
        
        .delete-order-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            margin-top: 15px;
            width: 100%;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 10px rgba(255, 71, 87, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .delete-order-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }
        
        .delete-order-btn:hover::before {
            width: 200px;
            height: 200px;
        }
        
        .delete-order-btn:hover {
            background: linear-gradient(135deg, #ff4757 0%, #ff6b6b 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(255, 71, 87, 0.4);
        }

        /* Объявления */
        .announcement-card {
            background-color: var(--main-color);
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 2px solid var(--dark-color);
            margin-bottom: 20px;
            position: relative;
            transition: all 0.3s ease;
            animation: fadeInUp 0.5s ease;
        }
        .announcement-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        .announcement-card.pinned { 
            border: 3px solid #ffd700; 
            background: linear-gradient(135deg, #fff9e6, #fff2cc);
        }
        .pinned-icon {
            position: absolute;
            top: -10px;
            left: 20px;
            background-color: #ffd700;
            color: var(--dark-color);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(45deg);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        .announcement-card:hover .pinned-icon {
            transform: rotate(90deg);
        }
        .announcement-title {
            font-size: 1.5rem;
            color: var(--dark-color);
            font-family: var(--handwritten-font);
            font-weight: 700;
            margin-bottom: 10px;
        }
        .announcement-text { 
            font-size: 1.1rem; 
            line-height: 1.5; 
        }
        .announcement-text a {
            color: var(--dark-color);
            font-weight: 700;
            text-decoration: none;
            border-bottom: 2px solid var(--dark-color);
            transition: all 0.3s ease;
        }
        .announcement-text a:hover {
            color: #7a4f29;
            border-bottom-color: #7a4f29;
            padding-bottom: 2px;
        }
        .announcement-date { 
            margin-top: 15px; 
            text-align: right; 
            font-style: italic; 
            color: #666; 
            font-size: 0.9rem;
        }

        /* Обратная связь (Яндекс Форма) */
        .feedback-container {
            padding: 15px 0;
            display: flex;
            justify-content: center;
            background-color: #f9f9f9;
            border-radius: 16px;
            min-height: 500px;
        }
        .ya-form-frame {
            width: 100%;
            max-width: 650px;
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* Модальное окно оценки */
        .rating-modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex; align-items: center; justify-content: center;
            z-index: 3000; opacity: 0; visibility: hidden; transition: all 0.3s ease;
        }
        .rating-modal-overlay.active { opacity: 1; visibility: visible; }
        .rating-modal {
            background-color: white; width: 90%; max-width: 400px; border-radius: 20px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); transform: translateY(-20px); transition: transform 0.3s ease;
        }
        .rating-modal-overlay.active .rating-modal { transform: translateY(0); }
        .rating-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .rating-modal-title { font-size: 1.8rem; color: var(--dark-color); font-family: var(--handwritten-font); font-weight: 700; }
        .close-rating-modal { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666; transition: transform 0.3s ease; }
        .close-rating-modal:hover { transform: rotate(90deg); color: var(--dark-color); }
        .rating-stars { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; }
        .rating-star { font-size: 2.5rem; color: #ddd; cursor: pointer; transition: all 0.3s ease; }
        .rating-star:hover, .rating-star.active { color: #ffc107; transform: scale(1.1); }

        /* Уведомление */
        .cart-notification {
            position: fixed; top: 20px; right: 20px; background-color: var(--dark-color); color: white;
            padding: 15px 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 2500; display: flex; align-items: center; gap: 12px;
            transform: translateX(120%); transition: transform 0.4s ease; max-width: 350px;
        }
        .cart-notification.show { transform: translateX(0); }
        .notification-icon { font-size: 1.5rem; color: var(--main-color); }

        /* Кнопка наверх */
        .scroll-to-top {
            position: fixed; bottom: 100px; right: 20px; width: 50px; height: 50px;
            background-color: var(--dark-color); color: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
            cursor: pointer; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease; z-index: 1500; opacity: 0; visibility: hidden;
        }
        .scroll-to-top.visible { opacity: 1; visibility: visible; }
        .scroll-to-top:hover { transform: translateY(-5px) scale(1.1); }

        /* Футер */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 30px 0 20px;
            text-align: center;
            margin-top: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        footer:hover {
            background-color: #6a4a2a;
        }
        
        .footer-logo-container { margin-bottom: 15px; }
        .footer-logo { 
            height: 70px; 
            width: 70px; 
            border-radius: 50%; 
            overflow: hidden; 
            margin: 0 auto 10px;
            transition: all 0.3s ease;
        }
        
        .footer-logo img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover;
            transition: all 0.3s ease;
        }
        
        .itd-button { 
            display: inline-block; 
            width: 45px; 
            height: 45px; 
            border-radius: 50%; 
            background-color: white; 
            margin: 10px; 
            overflow: hidden; 
            transition: all 0.3s ease; 
        }
        .itd-button:hover { transform: scale(1.1) rotate(5deg); }
        .itd-button img { width: 100%; height: 100%; object-fit: contain; padding: 8px; }
        .footer-disclaimer { margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.2); font-size: 0.85rem; }

        /* Адаптивность */
        @media (max-width: 768px) {
            body { padding-bottom: 85px; }
            .logo-image {
                height: 60px;
            }
            .banner-carousel { height: 40vh; min-height: 250px; }
            .about-section h2, .features-section h2, .reviews-section h2 { font-size: 2rem; }
            .menu-header h2 { font-size: 2.2rem; }
            .more-panel { height: 85vh; }
            .delivery-options { flex-direction: column; gap: 10px; }
            .bonus-balance-info { margin-left: 0; }
            .bonus-warning { margin-left: 0; }
            .cart-page-content { padding: 15px; }
            .cart-page-item { padding: 12px; }
            .bottom-nav {
                bottom: 15px;
                width: calc(100% - 30px);
                padding: 6px 8px;
                border-radius: 35px;
            }
            .nav-item {
                padding: 6px 12px;
            }
        }
        @media (max-width: 480px) {
            body { padding-bottom: 80px; }
            .logo-image {
                height: 50px;
            }
            .banner-carousel { height: 35vh; min-height: 200px; }
            .about-section, .contact-section { padding: 20px; }
            .features-grid, .reviews-grid, .menu-grid { grid-template-columns: 1fr; }
            .bonus-card-button { flex-direction: column; text-align: center; }
            .bonus-card-text h4 { font-size: 1rem; }
            .cart-page-total { font-size: 1.2rem; padding: 15px; }
            .bottom-nav {
                bottom: 10px;
                width: calc(100% - 20px);
                border-radius: 30px;
                padding: 5px 5px;
            }
            .nav-item {
                padding: 5px 8px;
            }
            .nav-item i {
                font-size: 1.3rem;
            }
        }
    </style>
    
    <!-- Скрипт для Яндекс Формы -->
    <script src="https://forms.yandex.ru/_static/embed.js"></script>
</head>
<body>
    <!-- Контейнер для падающих ахмедиков -->
    <div id="falling-ahmediks-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999;"></div>

    <!-- ЗАГРУЗОЧНЫЙ ЭКРАН -->
    <div class="loading-screen" id="loadingScreen">
        <img src="img/img/loading.gif" alt="Загрузка" class="loading-gif">
    </div>

    <!-- МОДАЛЬНОЕ ОКНО ДЛЯ ОЦЕНКИ -->
    <div class="rating-modal-overlay" id="ratingModalOverlay">
        <div class="rating-modal">
            <div class="rating-modal-header">
                <h3 class="rating-modal-title">Оцените качество</h3>
                <button class="close-rating-modal" id="closeRatingModal">&times;</button>
            </div>
            <div class="rating-modal-content">
                <p style="text-align: center; margin-bottom: 20px;">Пожалуйста, оцените качество заказа:</p>
                <div class="rating-stars">
                    <div class="rating-star" data-rating="1">★</div>
                    <div class="rating-star" data-rating="2">★</div>
                    <div class="rating-star" data-rating="3">★</div>
                    <div class="rating-star" data-rating="4">★</div>
                    <div class="rating-star" data-rating="5">★</div>
                </div>
                <input type="hidden" id="selectedRating" value="0">
                <input type="hidden" id="ratingOrderId" value="">
                <button class="received-btn" id="submitRating" style="margin-top: 10px;">Отправить оценку</button>
            </div>
        </div>
    </div>

    <!-- ВСПЛЫВАЮЩЕЕ УВЕДОМЛЕНИЕ -->
    <div class="cart-notification" id="cartNotification">
        <div class="notification-icon"><i class="fas fa-check-circle"></i></div>
        <div class="notification-content">
            <h4>Товар добавлен в корзину</h4>
            <p id="notificationMessage"></p>
        </div>
    </div>

    <!-- КНОПКА "НАВЕРХ" -->
    <div class="scroll-to-top" id="scrollToTop"><i class="fas fa-chevron-up"></i></div>

    <!-- ШАПКА ТОЛЬКО С ЛОГОТИПОМ ПО ЦЕНТРУ -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-image">
                        <img src="img/img/logo-big.png" alt="Логотип Шашлычной 'У Ахмеда'">
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ОСНОВНОЙ КОНТЕНТ - СТРАНИЦЫ -->
    <main>
        <!-- СТРАНИЦА ГЛАВНАЯ -->
        <div id="home-page" class="page active">
            <section class="banner-carousel">
                <div class="carousel-container" id="carouselContainer">
                    <div class="carousel-track" id="carouselTrack">
                        <div class="carousel-slide"><img src="img/img/banner1.png" alt="Баннер 1"></div>
                        <div class="carousel-slide"><img src="img/img/banner2.png" alt="Баннер 2"></div>
                        <div class="carousel-slide"><img src="img/img/banner3.png" alt="Баннер 3"></div>
                    </div>
                </div>
            </section>

            <div class="container">
                <section class="about-section">
                    <h2>О нашем заведении</h2>
                    <p>Срухаланцы приходят в нашу шашлычную, чтобы насладиться вкусом нашего ароматного шашлыка, а уют заведения не дает им покинуть его. У нас самый лучший шашлык по мнению губернатора Срухаланска Пихоря Пижонова. Клиенты еще никогда не были разочарованы шашлычной «У Ахмеда!»</p>
                </section>

                <section class="features-section">
                    <h2>Почему выбирают нас?</h2>
                    <div class="features-grid">
                        <div class="feature-card"><div class="feature-icon"><i class="fas fa-skull-crossbones"></i></div><h3>Убогое качество, но вкусные блюда</h3><p>Внешний вид не главное, главное - это неповторимый вкус!</p></div>
                        <div class="feature-card"><div class="feature-icon"><i class="fas fa-user-graduate"></i></div><h3>Неопытные повара</h3><p>Наши повара постоянно экспериментируют, чтобы удивить вас!</p></div>
                        <div class="feature-card"><div class="feature-icon"><i class="fas fa-hourglass-half"></i></div><h3>Долгая готовка и доставка</h3><p>Мы не торопимся, чтобы всё было идеально приготовлено</p></div>
                        <div class="feature-card"><div class="feature-icon"><i class="fas fa-rocket"></i></div><h3>Космические цены</h3><p>За качество такого уровня нужно платить соответственно!</p></div>
                    </div>
                </section>

                <section class="reviews-section">
                    <h2>Отзывы</h2>
                    <div class="reviews-grid">
                        <div class="review-card"><div class="review-header"><div class="review-name">Туманова Елена</div><div class="review-rating">★★★★★</div></div><div class="review-text">Лучший ресторан, всегда сюда с коллегами захожу, а они тают от запаха.</div></div>
                        <div class="review-card"><div class="review-header"><div class="review-name">Пердато Сеньорита</div><div class="review-rating">★★★★★</div></div><div class="review-text">Раньше думала что в этом Срухаланске все рестораны отстойные, но поменяла свое мнение после того как поела здесь! Лучше чем у меня на родине!</div></div>
                        <div class="review-card"><div class="review-header"><div class="review-name">Ахмедов Абдулла</div><div class="review-rating">★★★★★</div></div><div class="review-text">Братья маладцы, никогда мимо не проезжаю, все невераятна вкусна.</div></div>
                        <div class="review-card"><div class="review-header"><div class="review-name">Минова Амина</div><div class="review-rating">★★★★★</div></div><div class="review-text">Сайт просто супер! Большой выбор товара. Качество топ. Отравилась за секунду! Все довольны хочу организовать свадьбу под названием "LoveУшкА"</div></div>
                        <div class="review-card"><div class="review-header"><div class="review-name">Апельсинова Айгуль</div><div class="review-rating">★★★★★</div></div><div class="review-text">шашлык прекрасный, дали с плесенью😊</div></div>
                        <div class="review-card bad-review"><div class="review-header"><div class="review-name">Коноплёва Жанна</div><div class="review-rating">★☆☆☆☆</div></div><div class="review-text">Ужас, как будто навоз сожрала, в туалете все вырагала так ещё и в углу нашла тону тараканов.</div></div>
                    </div>
                </section>
            </div>
        </div>

        <!-- СТРАНИЦА МЕНЮ -->
        <div id="menu-page" class="page">
            <div class="container">
                <section class="menu-header">
                    <h2>Меню</h2>
                    <p>Выберите категорию и наслаждайтесь нашими лучшими блюдами</p>
                </section>

                <div class="categories">
                    <button class="category-btn active" data-category="shashlik">Шашлык</button>
                    <button class="category-btn" data-category="asia">Сочная азия</button>
                    <button class="category-btn" data-category="sauces">Соусы</button>
                    <button class="category-btn" data-category="drinks">Напитки</button>
                </div>

                <section id="shashlik" class="menu-section active"><h2 class="section-title">Шашлык</h2><div class="menu-grid" id="shashlikGrid"></div></section>
                <section id="asia" class="menu-section"><h2 class="section-title">Сочная азия</h2><div class="menu-grid" id="asiaGrid"></div></section>
                <section id="sauces" class="menu-section"><h2 class="section-title">Соусы</h2><div class="menu-grid" id="saucesGrid"></div></section>
                <section id="drinks" class="menu-section"><h2 class="section-title">Напитки</h2><div class="menu-grid" id="drinksGrid"></div></section>
            </div>
        </div>

        <!-- СТРАНИЦА КОРЗИНА (С ОТСТУПАМИ) -->
        <div id="cart-page" class="page">
            <div class="container cart-page-content">
                <h2 class="section-title">Ваша корзина</h2>
                <div class="cart-page-items" id="cartPageItems">
                    <p class="empty-cart-message">Ваша корзина пуста</p>
                </div>
                <div class="cart-page-total">
                    <span>Итого:</span>
                    <span id="cartPageTotal">0 ₽</span>
                </div>
                <button class="order-btn" id="cartPageOrderBtn" disabled>Оформить заказ</button>
            </div>
        </div>
    </main>

    <!-- ВЫЕЗЖАЮЩЕЕ ОКНО "ЕЩЁ" -->
    <div class="more-overlay" id="moreOverlay"></div>
    <div class="more-panel" id="morePanel">
        <div class="more-header">
            <button class="more-back-btn" id="moreBackBtn"><i class="fas fa-arrow-left"></i></button>
            <h2 id="morePanelTitle">Ещё</h2>
            <button class="close-more" id="closeMore">&times;</button>
        </div>
        <div class="more-content" id="moreContent">
            <!-- Главное меню -->
            <div class="more-main-menu" id="moreMainMenu">
                <div class="more-menu-item" id="moreOrdersBtn"><i class="fas fa-clock"></i><span>Недавние заказы</span></div>
                <div class="more-menu-item" id="moreBonusBtn"><i class="fas fa-percent"></i><span>Бонусная карта</span></div>
                <div class="more-menu-item" id="moreAnnouncementBtn"><i class="fas fa-bullhorn"></i><span>Объявления</span></div>
                <div class="more-menu-item" id="moreFeedbackBtn"><i class="fas fa-envelope"></i><span>Обратная связь</span></div>
            </div>

            <!-- Панель Бонусной карты -->
            <div class="more-content-panel" id="moreBonusPanel">
                <div class="bonus-image-container">
                    <img src="img/img/bonus.png" alt="Бонусная карта" class="bonus-image" id="bonusImage">
                </div>
                <div class="bonus-description">Бонусная карта "У Ахмеда" позволит вам жрать еще выгоднее! Оплачивайте часть покупки с помощью ахмедиков и получайте неимоверные скидки</div>
                <div class="bonus-balance-container" id="bonusBalanceContainer"></div>
                <div class="bonus-tabs">
                    <div class="bonus-tab active" data-tab="get">Как получить</div>
                    <div class="bonus-tab" data-tab="spend">Как потратить</div>
                </div>
                <div class="bonus-tab-content active" id="getTab">Используйте карту при оплате и получите 2-4 ахмедика</div>
                <div class="bonus-tab-content" id="spendTab">С помощью полученных бонусов оплатите 0,0000001% покупки или заказа</div>
                <div class="bonus-form" id="bonusForm">
                    <h3 style="color: var(--dark-color); margin-bottom: 15px; text-align: center;">Активировать карту</h3>
                    <form id="activateBonusForm">
                        <div class="form-group"><label for="bonusFullName">ФИО держателя</label><input type="text" id="bonusFullName" class="form-control" required></div>
                        <div class="form-group"><label for="bonusEmail">Электронная почта</label><input type="email" id="bonusEmail" class="form-control" required></div>
                        <div class="form-group"><label for="bonusCardNumber">Номер карты (8 цифр)</label><input type="text" id="bonusCardNumber" class="form-control" pattern="[0-9]{8}" maxlength="8" placeholder="12345678" required></div>
                        <button type="submit" class="submit-btn">Активировать карту</button>
                    </form>
                </div>
            </div>

            <!-- Панель Заказов -->
            <div class="more-content-panel" id="moreOrdersPanel">
                <div class="orders-container" id="ordersContainer"></div>
            </div>

            <!-- Панель Объявлений -->
            <div class="more-content-panel" id="moreAnnouncementPanel">
                <div class="announcement-card pinned">
                    <div class="pinned-icon"><i class="fas fa-thumbtack"></i></div>
                    <div class="announcement-title">Подпишитесь на наш ИТД канал</div>
                    <div class="announcement-text"><a href="https://итд.com/uahmeda52" target="_blank">итд.com/uahmeda52</a></div>
                </div>
                <div class="announcement-card">
                    <div class="announcement-title">Изменения от 21 февраля</div>
                    <div class="announcement-text">переработан дизайн навигации</div>
                    <div class="announcement-date">21.02.2026</div>
                </div>
                <div class="announcement-card">
                    <div class="announcement-title">Изменения от 18.02.2026</div>
                    <div class="announcement-text">Добавлено раскрывающееся меню, вкладка «Объявления»</div>
                    <div class="announcement-date">18 февраля 2026 г.</div>
                </div>
            </div>

            <!-- Панель Обратная связь (Яндекс Форма) -->
            <div class="more-content-panel" id="moreFeedbackPanel">
                <h2 class="section-title">Обратная связь</h2>
                <div class="feedback-container">
                    <iframe src="https://forms.yandex.ru/u/6998a2c71f1eb5cd701980cf?iframe=1" 
                            frameborder="0" 
                            name="ya-form-6998a2c71f1eb5cd701980cf" 
                            width="100%" 
                            height="600px"
                            class="ya-form-frame"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- НИЖНЕЕ НАВИГАЦИОННОЕ МЕНЮ - С ПЛАШКОЙ -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-page="home"><i class="fas fa-home"></i><span>Главная</span></button>
        <button class="nav-item" data-page="menu"><i class="fas fa-book"></i><span>Меню</span></button>
        <button class="nav-item" data-page="cart" id="navCartBtn">
            <i class="fas fa-shopping-cart"></i>
            <span>Корзина</span>
            <span class="cart-count-badge" id="navCartCount">0</span>
        </button>
        <button class="nav-item" data-page="more" id="navMoreBtn"><i class="fas fa-ellipsis-h"></i><span>Ещё</span></button>
    </nav>

    <!-- Модальное окно оформления заказа -->
    <div class="modal-overlay" id="orderModal" style="position: fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center; z-index:4000; opacity:0; visibility:hidden; transition:all 0.3s ease;">
        <div class="modal" style="background-color:white; width:90%; max-width:500px; border-radius:20px; padding:30px; box-shadow:0 10px 30px rgba(0,0,0,0.2);">
            <div class="modal-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
                <h3 class="modal-title" style="font-size:1.8rem; color:var(--dark-color); font-family:var(--handwritten-font);">Оформление заказа</h3>
                <button class="close-modal" id="closeModal" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-content">
                <form id="orderForm">
                    <div class="form-group"><label for="customerName">Ваше имя</label><input type="text" id="customerName" class="form-control" required></div>
                    <div class="form-group"><label for="customerEmail">Электронная почта</label><input type="email" id="customerEmail" class="form-control" required></div>
                    
                    <div class="delivery-options">
                        <div class="delivery-option"><input type="radio" id="pickup" name="deliveryType" value="pickup" checked><label for="pickup">Забрать в ресторане</label></div>
                        <div class="delivery-option"><input type="radio" id="delivery" name="deliveryType" value="delivery"><label for="delivery">Доставить по адресу</label></div>
                    </div>
                    
                    <div class="form-group delivery-address-group" id="deliveryAddressGroup">
                        <label for="customerAddress">Адрес доставки</label>
                        <input type="text" id="customerAddress" class="form-control">
                    </div>

                    <!-- Кнопка-карточка бонусной карты (БЕЗ ЧЕКБОКСА) -->
                    <div class="bonus-card-button" id="bonusCardButton">
                        <img src="img/img/bonus-card.png" alt="Бонусная карта" class="bonus-card-image">
                        <div class="bonus-card-text">
                            <h4>Использовать бонусную карту</h4>
                            <p>Скидка 1 рубль + начисление 2-4 ахмедиков</p>
                        </div>
                        <!-- Чекбокс скрыт, но оставлен для логики -->
                        <input type="checkbox" class="bonus-card-checkbox" id="useBonusCardInOrder" style="display: none;">
                    </div>
                    
                    <div class="bonus-balance-info" id="bonusBalanceInfo">
                        <i class="fas fa-wallet"></i> Баланс: <span id="bonusBalanceDisplay">0</span> ахмедиков
                    </div>
                    
                    <div class="bonus-warning" id="bonusWarning" style="display: none;">
                        <i class="fas fa-exclamation-circle"></i> Бонусную карту можно использовать только в заказах от 500 рублей
                    </div>

                    <button type="submit" class="submit-order">Подтвердить заказ</button>
                </form>
                
                <div class="order-success" id="orderSuccess" style="display: none; text-align:center;">
                    <i class="fas fa-check-circle" style="font-size:4rem; color:#4caf50; margin-bottom:20px;"></i>
                    <h3 style="color:var(--dark-color); margin-bottom:15px; font-family:var(--handwritten-font);">Заказ успешно оформлен!</h3>
                    <p>Номер вашего заказа: <strong id="orderNumber">AHM-001</strong></p>
                    <p id="bonusEarnedInfo" style="display: none;">Вам начислено: <strong id="bonusEarned">0</strong> ахмедиков</p>
                    <p id="bonusSpentInfo" style="display: none;">Списано с карты: <strong id="bonusSpent">0</strong> ахмедиков</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Футер -->
    <footer id="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo-container">
                    <div class="footer-logo"><img src="img/img/logo.png" alt="Логотип" id="footer-logo-img"></div>
                    <p style="font-size: 1.2rem;">Шашлычная "У Ахмеда"</p>
                </div>
                <div class="footer-info">
                    <p>г. Срухаланск, ул. Нахалова 32</p>
                    <p>Ежедневно с 10:00 до 23:00</p>
                    <p class="footer-email">uahmeda52@list.ru</p>
                </div>
                <a href="https://итд.com/uahmeda52" target="_blank" class="itd-button"><img src="img/img/itd-logo.png" alt="ИТД"></a>
                <div class="footer-disclaimer">Сайт является шуточным и созданным в юмористических целях. Мы не предоставляем никаких услуг, а покупки невозможны.</div>
            </div>
        </div>
    </footer>

    <script>
        // ========== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ==========
        let currentPage = 'home';
        let cart = [];
        let orders = [];
        let orderNumber = 1;
        let userId = localStorage.getItem('ahmedUserId') || 'user_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('ahmedUserId', userId);
        let bonusCard = null;

        // ========== DOM ЭЛЕМЕНТЫ ==========
        const loadingScreen = document.getElementById('loadingScreen');
        const pages = document.querySelectorAll('.page');
        const navItems = document.querySelectorAll('.nav-item');
        const navCartCount = document.getElementById('navCartCount');
        const cartPageItems = document.getElementById('cartPageItems');
        const cartPageTotal = document.getElementById('cartPageTotal');
        const cartPageOrderBtn = document.getElementById('cartPageOrderBtn');
        const orderModal = document.getElementById('orderModal');
        const closeModal = document.getElementById('closeModal');
        const orderForm = document.getElementById('orderForm');
        const orderSuccess = document.getElementById('orderSuccess');
        const orderNumberElement = document.getElementById('orderNumber');
        const deliveryTypeRadios = document.querySelectorAll('input[name="deliveryType"]');
        const deliveryAddressGroup = document.getElementById('deliveryAddressGroup');
        const deliveryAddressInput = document.getElementById('customerAddress');
        const cartNotification = document.getElementById('cartNotification');
        const notificationMessage = document.getElementById('notificationMessage');
        const scrollToTopBtn = document.getElementById('scrollToTop');
        
        // Элементы окна "Ещё"
        const moreOverlay = document.getElementById('moreOverlay');
        const morePanel = document.getElementById('morePanel');
        const closeMore = document.getElementById('closeMore');
        const moreBackBtn = document.getElementById('moreBackBtn');
        const morePanelTitle = document.getElementById('morePanelTitle');
        const moreMainMenu = document.getElementById('moreMainMenu');
        const moreBonusPanel = document.getElementById('moreBonusPanel');
        const moreOrdersPanel = document.getElementById('moreOrdersPanel');
        const moreAnnouncementPanel = document.getElementById('moreAnnouncementPanel');
        const moreFeedbackPanel = document.getElementById('moreFeedbackPanel');
        const moreOrdersBtn = document.getElementById('moreOrdersBtn');
        const moreBonusBtn = document.getElementById('moreBonusBtn');
        const moreAnnouncementBtn = document.getElementById('moreAnnouncementBtn');
        const moreFeedbackBtn = document.getElementById('moreFeedbackBtn');

        // Элементы бонусной карты
        const bonusBalanceContainer = document.getElementById('bonusBalanceContainer');
        const bonusForm = document.getElementById('bonusForm');
        const activateBonusForm = document.getElementById('activateBonusForm');
        const bonusCardNumberInput = document.getElementById('bonusCardNumber');
        const bonusImage = document.getElementById('bonusImage');
        const bonusTabs = document.querySelectorAll('.bonus-tab');
        const bonusTabContents = document.querySelectorAll('.bonus-tab-content');
        const bonusCardButton = document.getElementById('bonusCardButton');
        const useBonusCardInOrder = document.getElementById('useBonusCardInOrder');
        const bonusBalanceDisplay = document.getElementById('bonusBalanceDisplay');
        const bonusBalanceInfo = document.getElementById('bonusBalanceInfo');
        const bonusWarning = document.getElementById('bonusWarning');
        const bonusEarnedInfo = document.getElementById('bonusEarnedInfo');
        const bonusEarned = document.getElementById('bonusEarned');
        const bonusSpentInfo = document.getElementById('bonusSpentInfo');
        const bonusSpent = document.getElementById('bonusSpent');

        // Элементы заказов
        const ordersContainer = document.getElementById('ordersContainer');
        
        // Элементы модалки оценки
        const ratingModalOverlay = document.getElementById('ratingModalOverlay');
        const closeRatingModal = document.getElementById('closeRatingModal');
        const ratingStars = document.querySelectorAll('.rating-star');
        const selectedRatingInput = document.getElementById('selectedRating');
        const ratingOrderIdInput = document.getElementById('ratingOrderId');
        const submitRatingBtn = document.getElementById('submitRating');

        // Элементы для гравитации
        const footer = document.getElementById('footer');
        const footerLogo = document.getElementById('footer-logo-img');

        // ========== ДАННЫЕ МЕНЮ ==========
        const menuData = {
            shashlik: [ { id: 2, name: "Шашлык из курицы", description: "Сочные куриные бедра на мангале", price: 280, image: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600&h=400&fit=crop" }, { id: 3, name: "Люля-кебаб из баранины", description: "Традиционный кавказский люля-кебаб", price: 420, image: "https://images.unsplash.com/photo-1529193591184-b1d58069ecdd?w=600&h=400&fit=crop" }, { id: 4, name: "Шашлык из говядины", description: "Пряная говядина на углях", price: 380, image: "https://images.unsplash.com/photo-1544025162-d76694265947?w=600&h=400&fit=crop" }, { id: 18, name: "Лаваш", description: "Свежий тонкий лаваш для шашлыка", price: 80, image: "https://images.unsplash.com/photo-1641664734521-78b8c8f5e9b2?w=600&h=400&fit=crop" } ],
            asia: [ { id: 30, name: "Бешбармак", description: "Традиционное казахское блюдо из мяса и теста", price: 450, image: "https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=600&h=400&fit=crop" }, { id: 31, name: "Баурсаки (3 штуки)", description: "Пышные жареные пончики по-казахски", price: 120, image: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600&h=400&fit=crop" }, { id: 32, name: "Плов по-узбекски", description: "Ароматный узбекский плов с бараниной", price: 380, image: "https://images.unsplash.com/photo-1563379926898-05f4575a45d8?w=600&h=400&fit=crop&auto=format" }, { id: 33, name: "Кумыс", description: "Традиционный кисломолочный напиток", price: 150, image: "https://images.unsplash.com/photo-1621506289937-a8e4df240d0b?w=600&h=400&fit=crop" }, { id: 34, name: "Эчпочмаки (3 штуки)", description: "Татарские треугольные пирожки с мясом", price: 180, image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=600&h=400&fit=crop" }, { id: 35, name: "Чак-чак", description: "Восточная сладость из теста с медом", price: 200, image: "https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?w=600&h=400&fit=crop" } ],
            sauces: [ { id: 16, name: "Сырный соус", description: "Ароматный сливочно-сырный соус с травами", price: 95, image: "https://images.unsplash.com/photo-1563379926898-05f4575a45d8?w=600&h=400&fit=crop&auto=format" }, { id: 17, name: "Кетчуп домашний", description: "Натуральный томатный кетчуп с пряностями", price: 65, image: "https://images.unsplash.com/photo-1576193492451-bc6d703a5b3b?w=600&h=400&fit=crop&auto=format" }, { id: 19, name: "Чесночный соус", description: "Ароматный соус на основе чеснока и сметаны", price: 75, image: "https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=600&h=400&fit=crop" } ],
            drinks: [ { id: 11, name: "Лимонад домашний", description: "Освежающий лимонад с мятой и лимоном", price: 120, image: "https://images.unsplash.com/photo-1621506289937-a8e4df240d0b?w=600&h=400&fit=crop" }, { id: 14, name: "Чай черный", description: "Ароматный черный чай с травами", price: 70, image: "https://images.unsplash.com/photo-1568649929103-28ffbefaca1e?w=600&h=400&fit=crop&auto=format" }, { id: 15, name: "Кофе по-восточному", description: "Ароматный кофе с кардамоном", price: 150, image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=600&h=400&fit=crop" }, { id: 20, name: "Чай с лимоном", description: "Ароматный чай с долькой лимона", price: 85, image: "https://images.unsplash.com/photo-1567337560842-9d2d11f9b1b7?w=600&h=400&fit=crop" }, { id: 21, name: "Зелёный чай", description: "Освежающий зеленый чай с жасмином", price: 90, image: "https://images.unsplash.com/photo-1561047029-3000c68339ca?w=600&h=400&fit=crop" } ]
        };

        // ========== ФУНКЦИЯ ДЛЯ ПАДЕНИЯ АХМЕДИКОВ ==========
        function createFallingAhmediks(count = 20) {
            const container = document.getElementById('falling-ahmediks-container');
            
            for (let i = 0; i < count; i++) {
                const ahmedik = document.createElement('img');
                ahmedik.src = 'img/img/ahmedik.png';
                ahmedik.className = 'ahmedik-fall';
                
                // Случайная позиция по горизонтали
                const left = Math.random() * 100;
                // Случайная задержка начала анимации
                const delay = Math.random() * 1.5;
                // Случайный размер
                const size = 30 + Math.random() * 40;
                
                ahmedik.style.left = left + '%';
                ahmedik.style.animationDelay = delay + 's';
                ahmedik.style.width = size + 'px';
                ahmedik.style.height = size + 'px';
                
                // Добавляем небольшую вариацию в анимацию
                ahmedik.style.filter = `hue-rotate(${Math.random() * 30}deg) drop-shadow(0 0 ${5 + Math.random() * 10}px var(--main-color))`;
                
                container.appendChild(ahmedik);
                
                // Удаляем элемент после завершения анимации
                setTimeout(() => {
                    if (ahmedik.parentNode) {
                        ahmedik.remove();
                    }
                }, 2000 + delay * 1000);
            }
        }

        // ========== ФУНКЦИЯ ДЛЯ ЭФФЕКТА ГРАВИТАЦИИ ==========
        function applyGravityEffect() {
            // Получаем все элементы, которые будем анимировать
            const elements = document.querySelectorAll('header, .banner-carousel, .about-section, .features-section, .reviews-section, .menu-header, .categories, .menu-section, .cart-page-content, footer, .bottom-nav, .more-overlay, .more-panel, .rating-modal-overlay, .cart-notification, .scroll-to-top');
            
            elements.forEach(el => {
                // Генерируем случайные значения для анимации
                const randomValues = {
                    '--x': (Math.random() - 0.5) * 200,
                    '--y': (Math.random() - 0.5) * 200,
                    '--r': (Math.random() - 0.5) * 360,
                    '--x2': (Math.random() - 0.5) * 300,
                    '--y2': (Math.random() - 0.5) * 300,
                    '--r2': (Math.random() - 0.5) * 720,
                    '--x3': (Math.random() - 0.5) * 250,
                    '--y3': (Math.random() - 0.5) * 250,
                    '--r3': (Math.random() - 0.5) * 540,
                    '--x4': (Math.random() - 0.5) * 200,
                    '--y4': (Math.random() - 0.5) * 200,
                    '--r4': (Math.random() - 0.5) * 360,
                };
                
                // Применяем переменные к элементу
                Object.keys(randomValues).forEach(key => {
                    el.style.setProperty(key, randomValues[key]);
                });
                
                // Добавляем класс с анимацией
                el.classList.add('gravity-active');
            });
            
            // Убираем класс после завершения анимации
            setTimeout(() => {
                elements.forEach(el => {
                    el.classList.remove('gravity-active');
                });
            }, 2000);
        }

        // ========== ИНИЦИАЛИЗАЦИЯ ==========
        setTimeout(() => loadingScreen.classList.add('hidden'), 1000);

        // Заполнение меню
        for (const cat in menuData) {
            const grid = document.getElementById(`${cat}Grid`);
            menuData[cat].forEach(item => {
                const div = document.createElement('div');
                div.className = 'menu-item';
                div.innerHTML = `<div class="item-image"><img src="${item.image}" alt="${item.name}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZmNjZDk3Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzVjM2QxZSI+U2hhc2hseWs8L3RleHQ+PC9zdmc+';"></div><div class="item-info"><h3 class="item-name">${item.name}</h3><p class="item-description">${item.description}</p><div class="item-footer"><div class="item-price">${item.price} ₽</div><button class="add-to-cart" data-id="${item.id}">Добавить</button></div></div>`;
                grid.appendChild(div);
            });
        }

        // Карусель
        const carouselTrack = document.getElementById('carouselTrack');
        const slides = document.querySelectorAll('.carousel-slide');
        let currentSlide = 0, slideInterval;
        function showSlide(index) { currentSlide = index; carouselTrack.style.transform = `translateX(-${currentSlide * 100}%)`; }
        function nextSlide() { showSlide((currentSlide + 1) % slides.length); }
        function startAutoSlide() { clearInterval(slideInterval); slideInterval = setInterval(nextSlide, 5000); }
        startAutoSlide();
        document.getElementById('carouselContainer').addEventListener('mouseenter', () => clearInterval(slideInterval));
        document.getElementById('carouselContainer').addEventListener('mouseleave', startAutoSlide);
        slides[1]?.querySelector('img')?.addEventListener('click', () => { closeMorePanel(); openMorePanel(); showBonusInMore(); });

        // Категории меню
        document.querySelectorAll('.category-btn').forEach(btn => btn.addEventListener('click', function() {
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            document.querySelectorAll('.menu-section').forEach(s => s.classList.remove('active'));
            document.getElementById(this.dataset.category).classList.add('active');
        }));

        // ========== УПРАВЛЕНИЕ СТРАНИЦАМИ ==========
        function switchPage(pageId) {
            currentPage = pageId;
            pages.forEach(p => p.classList.remove('active'));
            document.getElementById(`${pageId}-page`).classList.add('active');
            
            // Обновляем активный класс в навигации
            navItems.forEach(item => {
                if (item.dataset.page === pageId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            if (pageId === 'cart') renderCartPage();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const page = item.dataset.page;
                if (page === 'more') {
                    openMorePanel();
                } else {
                    switchPage(page);
                }
            });
        });

        // ========== УПРАВЛЕНИЕ ОКНОМ "ЕЩЁ" ==========
        function openMorePanel() {
            moreOverlay.classList.add('active');
            morePanel.classList.add('active');
            document.body.style.overflow = 'hidden';
            showMoreMainMenu();
        }
        function closeMorePanel() {
            moreOverlay.classList.remove('active');
            morePanel.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        function showMoreMainMenu() {
            moreMainMenu.classList.remove('hidden');
            moreBonusPanel.classList.remove('active');
            moreOrdersPanel.classList.remove('active');
            moreAnnouncementPanel.classList.remove('active');
            moreFeedbackPanel.classList.remove('active');
            moreBackBtn.classList.remove('visible');
            morePanelTitle.textContent = 'Ещё';
        }
        function showBonusInMore() {
            moreMainMenu.classList.add('hidden');
            moreBonusPanel.classList.add('active');
            moreOrdersPanel.classList.remove('active');
            moreAnnouncementPanel.classList.remove('active');
            moreFeedbackPanel.classList.remove('active');
            moreBackBtn.classList.add('visible');
            morePanelTitle.textContent = 'Бонусная карта';
            loadBonusCardFromStorage();
            updateBonusDisplay();
        }
        function showOrdersInMore() {
            moreMainMenu.classList.add('hidden');
            moreOrdersPanel.classList.add('active');
            moreBonusPanel.classList.remove('active');
            moreAnnouncementPanel.classList.remove('active');
            moreFeedbackPanel.classList.remove('active');
            moreBackBtn.classList.add('visible');
            morePanelTitle.textContent = 'Недавние заказы';
            updateOrderStatuses();
            renderOrders();
        }
        function showAnnouncementInMore() {
            moreMainMenu.classList.add('hidden');
            moreAnnouncementPanel.classList.add('active');
            moreBonusPanel.classList.remove('active');
            moreOrdersPanel.classList.remove('active');
            moreFeedbackPanel.classList.remove('active');
            moreBackBtn.classList.add('visible');
            morePanelTitle.textContent = 'Объявления';
        }
        function showFeedbackInMore() {
            moreMainMenu.classList.add('hidden');
            moreFeedbackPanel.classList.add('active');
            moreBonusPanel.classList.remove('active');
            moreOrdersPanel.classList.remove('active');
            moreAnnouncementPanel.classList.remove('active');
            moreBackBtn.classList.add('visible');
            morePanelTitle.textContent = 'Обратная связь';
        }

        closeMore.addEventListener('click', closeMorePanel);
        moreOverlay.addEventListener('click', closeMorePanel);
        moreBackBtn.addEventListener('click', showMoreMainMenu);
        moreBonusBtn.addEventListener('click', showBonusInMore);
        moreOrdersBtn.addEventListener('click', showOrdersInMore);
        moreAnnouncementBtn.addEventListener('click', showAnnouncementInMore);
        moreFeedbackBtn.addEventListener('click', showFeedbackInMore);

        // ========== БОНУСНАЯ КАРТА ==========
        function saveBonusCardToStorage() { if (bonusCard) localStorage.setItem('ahmedBonusCard_' + userId, JSON.stringify(bonusCard)); else localStorage.removeItem('ahmedBonusCard_' + userId); }
        function loadBonusCardFromStorage() { const saved = localStorage.getItem('ahmedBonusCard_' + userId); if (saved) bonusCard = JSON.parse(saved); }
        function addBonusPoints(points) { 
            if (!bonusCard) return false; 
            bonusCard.balance += points; 
            saveBonusCardToStorage(); 
            updateBonusDisplay(); 
            
            // Запускаем анимацию падения ахмедиков при начислении бонусов
            createFallingAhmediks(15);
            
            return true; 
        }
        function deductBonusPoints(points) { 
            if (!bonusCard || bonusCard.balance < points) return false; 
            bonusCard.balance -= points; 
            if (bonusCard.firstUse) bonusCard.firstUse = false; 
            saveBonusCardToStorage(); 
            updateBonusDisplay(); 
            
            // Запускаем анимацию падения ахмедиков при списании бонусов
            createFallingAhmediks(10);
            
            return true; 
        }

        function updateBonusDisplay() {
            if (!bonusBalanceContainer) return;
            if (bonusCard) {
                bonusBalanceContainer.innerHTML = '';
                const positions = [ { top: '10%', left: '5%' }, { top: '5%', right: '10%' }, { bottom: '15%', left: '8%' }, { bottom: '5%', right: '15%' }];
                positions.forEach(pos => {
                    const img = document.createElement('img');
                    img.src = 'img/img/ahmedik.png';
                    img.className = 'ahmedik-img';
                    Object.assign(img.style, pos);
                    img.onerror = function() { this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2ZjY2Q5NyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM1YzNkMWUiPkFIPC90ZXh0Pjwvc3ZnPg=='; };
                    bonusBalanceContainer.appendChild(img);
                });
                const balanceDiv = document.createElement('div');
                balanceDiv.className = 'bonus-balance';
                balanceDiv.innerHTML = `<div class="bonus-card-number">Номер карты: ${bonusCard.cardNumber}</div><h3>Ваш баланс</h3><div class="bonus-balance-value"><span id="bonusBalanceValue">${bonusCard.balance}</span><span class="bonus-currency">ахмедиков</span></div>`;
                bonusBalanceContainer.appendChild(balanceDiv);
                bonusBalanceDisplay.textContent = bonusCard.balance;
                bonusBalanceInfo.style.display = 'flex';
                bonusForm.classList.add('hidden');
            } else {
                bonusBalanceContainer.innerHTML = '<p style="text-align:center; padding:20px;">У вас нет активной карты. Заполните форму ниже, чтобы активировать.</p>';
                bonusForm.classList.remove('hidden');
                bonusBalanceInfo.style.display = 'none';
            }
        }

        activateBonusForm?.addEventListener('submit', function(e) {
            e.preventDefault();
            const fullName = document.getElementById('bonusFullName').value;
            const email = document.getElementById('bonusEmail').value;
            const cardNumber = document.getElementById('bonusCardNumber').value;
            if (cardNumber.length !== 8) { alert('Номер карты должен содержать ровно 8 цифр'); return; }
            const savedBonusCards = JSON.parse(localStorage.getItem('ahmedBonusCards') || '[]');
            const existingCard = savedBonusCards.find(c => c.cardNumber === cardNumber);
            if (existingCard) {
                bonusCard = existingCard;
                alert(`Карта ${cardNumber} уже активирована. Баланс: ${bonusCard.balance} ахмедиков`);
                // Запускаем анимацию при активации карты
                createFallingAhmediks(8);
            } else {
                bonusCard = { id: 'bonus_' + Date.now(), fullName, email, cardNumber, balance: 0, firstUse: true, createdAt: new Date().getTime(), userId: userId };
                savedBonusCards.push(bonusCard);
                localStorage.setItem('ahmedBonusCards', JSON.stringify(savedBonusCards));
                alert('Бонусная карта успешно активирована!');
                // Запускаем анимацию при активации карты
                createFallingAhmediks(12);
            }
            saveBonusCardToStorage();
            updateBonusDisplay();
        });

        bonusCardNumberInput?.addEventListener('input', function() { this.value = this.value.replace(/\D/g, '').slice(0, 8); });
        bonusTabs.forEach(tab => tab.addEventListener('click', function() {
            const tabId = this.dataset.tab;
            bonusTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            bonusTabContents.forEach(c => c.classList.remove('active'));
            document.getElementById(tabId + 'Tab').classList.add('active');
        }));

        // ========== КОРЗИНА ==========
        function addToCart(itemId) {
            let item = null;
            for (const cat in menuData) { const found = menuData[cat].find(i => i.id === itemId); if (found) { item = found; break; } }
            if (!item) return;
            const existing = cart.find(i => i.id === itemId);
            if (existing) existing.quantity += 1; else cart.push({ ...item, quantity: 1 });
            updateCart();
            notificationMessage.textContent = `${item.name} добавлен в корзину`;
            cartNotification.classList.add('show');
            setTimeout(() => cartNotification.classList.remove('show'), 2000);
        }
        document.addEventListener('click', (e) => { if (e.target.classList.contains('add-to-cart')) addToCart(parseInt(e.target.dataset.id)); });

        function updateCart() {
            const totalItems = cart.reduce((s, i) => s + i.quantity, 0);
            navCartCount.textContent = totalItems;
            renderCartPage();
            saveCartToStorage();
        }

        function renderCartPage() {
            if (!cartPageItems) return;
            if (cart.length === 0) {
                cartPageItems.innerHTML = '<p class="empty-cart-message">Ваша корзина пуста</p>';
                cartPageTotal.textContent = '0 ₽';
                cartPageOrderBtn.disabled = true;
                return;
            }
            cartPageItems.innerHTML = '';
            cart.forEach(item => {
                const div = document.createElement('div');
                div.className = 'cart-page-item';
                div.innerHTML = `<div><strong>${item.name}</strong> x${item.quantity}<br><small>${item.price} ₽/шт</small></div><div><strong>${item.price * item.quantity} ₽</strong></div>`;
                cartPageItems.appendChild(div);
            });
            const total = cart.reduce((s, i) => s + i.price * i.quantity, 0);
            cartPageTotal.textContent = `${total} ₽`;
            cartPageOrderBtn.disabled = false;
        }

        function saveCartToStorage() { localStorage.setItem('ahmedCart', JSON.stringify(cart)); }
        function loadCartFromStorage() { const saved = localStorage.getItem('ahmedCart'); if (saved) { cart = JSON.parse(saved); updateCart(); } }

        // ========== ЗАКАЗЫ ==========
        function getNextOrderNumber() { return Math.max(orderNumber, (orders.filter(o => o.userId === userId).reduce((max, o) => Math.max(max, parseInt(o.id.replace('AHM-', ''))), 0)) + 1); }
        function createOrder(custData, cartItems, delType, addr, useBonus) {
            let total = cartItems.reduce((s, i) => s + i.price * i.quantity, 0);
            let bonusEarned = 0, bonusSpent = 0, bonusUsed = false;
            if (useBonus && bonusCard && total >= 500) {
                bonusUsed = true;
                total = Math.max(0, total - 1);
                bonusEarned = Math.floor(Math.random() * 3) + 2;
                addBonusPoints(bonusEarned);
                if (!bonusCard.firstUse && bonusCard.balance > 0) {
                    const maxDeduct = Math.min(bonusCard.balance, 5);
                    if (maxDeduct > 0) {
                        bonusSpent = Math.floor(Math.random() * maxDeduct) + 1;
                        bonusSpent = Math.min(bonusSpent, bonusCard.balance);
                        deductBonusPoints(bonusSpent);
                    }
                }
                if (bonusCard.firstUse) { bonusCard.firstUse = false; saveBonusCardToStorage(); }
            }
            const newOrderNumber = getNextOrderNumber();
            const order = {
                id: `AHM-${newOrderNumber.toString().padStart(3, '0')}`, userId, date: new Date().toLocaleDateString('ru-RU'),
                customerName: custData.name, customerEmail: custData.email,
                items: cartItems.map(i => ({ name: i.name, price: i.price, quantity: i.quantity })),
                total, deliveryType: delType, address: addr, status: 'ordered', statusChanged: new Date().getTime(),
                rating: null, bonusUsed, bonusEarned, bonusSpent, canBeReceived: delType === 'pickup'
            };
            orderNumber = newOrderNumber + 1;
            orders.unshift(order);
            saveOrdersToStorage();
            renderOrders();
            return order;
        }
        function saveOrdersToStorage() { localStorage.setItem('ahmedOrders', JSON.stringify(orders)); localStorage.setItem('ahmedOrderNumber', orderNumber.toString()); }
        function loadOrdersFromStorage() { 
            const savedOrders = localStorage.getItem('ahmedOrders');
            const savedNum = localStorage.getItem('ahmedOrderNumber');
            if (savedOrders) { orders = JSON.parse(savedOrders); updateOrderStatuses(); renderOrders(); }
            if (savedNum) orderNumber = parseInt(savedNum);
        }
        function updateOrderStatuses() {
            const now = new Date().getTime();
            const five = 5 * 60 * 1000, ten = 10 * 60 * 1000, fifteen = 15 * 60 * 1000;
            orders.forEach(o => {
                if (o.status === 'completed') return;
                const timePassed = now - o.statusChanged;
                if (o.status === 'ordered' && timePassed > five) { o.status = 'cooking'; o.statusChanged = now; }
                else if (o.status === 'cooking' && timePassed > ten) { o.status = o.deliveryType === 'delivery' ? 'delivery' : 'ready'; o.statusChanged = now; }
                else if (o.status === 'delivery' && timePassed > fifteen) { o.status = 'ready'; o.statusChanged = now; }
            });
            saveOrdersToStorage();
            renderOrders();
        }
        function renderOrders() {
            if (!ordersContainer) return;
            const userOrders = orders.filter(o => o.userId === userId);
            if (userOrders.length === 0) { ordersContainer.innerHTML = '<p class="no-orders">У вас еще нет заказов</p>'; return; }
            ordersContainer.innerHTML = '';
            userOrders.forEach(order => {
                const card = document.createElement('div');
                card.className = `order-card ${order.status === 'completed' ? 'completed' : ''}`;
                let itemsHtml = order.items.map(i => `<div class="order-item"><div>${i.name} x${i.quantity}</div><div class="item-total">${i.price * i.quantity} ₽</div></div>`).join('');
                let bonusHtml = order.bonusUsed ? `<div style="margin-top:10px; font-size:0.9rem; background:#f0f0f0; padding:8px; border-radius:8px;"><i class="fas fa-percent"></i> Использована карта${order.bonusEarned ? `<br>➕ Начислено: ${order.bonusEarned}` : ''}${order.bonusSpent ? `<br>➖ Списано: ${order.bonusSpent}` : ''}</div>` : '';
                let qrHtml = (order.status === 'ready' && order.deliveryType === 'pickup' && order.status !== 'completed') ? `<div class="qr-code-container show"><img src="img/img/qr-code.png" class="qr-code-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZmNjZDk3Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzVjM2QxZSI+UVItQ09ERTwvdGV4dD48L3N2Zz4+';"></div>` : '';
                let receivedBtnHtml = (order.status === 'ready' && order.status !== 'completed') ? `<button class="received-btn" data-order-id="${order.id}">${order.deliveryType === 'delivery' ? 'ЗАКАЗ ПОЛУЧЕН' : 'УЖЕ ЗАБРАЛ'}</button>` : '';
                let deleteBtnHtml = order.status === 'completed' ? `<button class="delete-order-btn" data-order-id="${order.id}"><i class="fas fa-trash"></i> Удалить заказ</button>` : '';
                let statusText = {ordered:'оформлен',cooking:'готовка',delivery:'доставка',ready:'ждет вас',completed:'получен'}[order.status] || order.status;
                card.innerHTML = `<div class="order-header"><div><div class="order-number">Заказ ${order.id}</div><div class="order-date">${order.date}</div></div><div class="order-status status-${order.status}">${statusText}</div></div><div class="order-items">${itemsHtml}</div>${bonusHtml}<div class="order-footer"><div class="order-total">${order.total} ₽</div><div class="order-type">${order.deliveryType === 'delivery' ? 'Доставка' : 'Самовывоз'}</div></div>${qrHtml}${receivedBtnHtml}${deleteBtnHtml}`;
                ordersContainer.appendChild(card);
            });
        }

        // ========== ОЦЕНКА ЗАКАЗА ==========
        let selectedRating = 0;
        function updateStarsDisplay(r) { ratingStars.forEach(s => { let sr = parseInt(s.dataset.rating); s.style.color = sr <= r ? '#ffc107' : '#ddd'; }); }
        ratingStars.forEach(s => s.addEventListener('click', function() { selectedRating = parseInt(this.dataset.rating); selectedRatingInput.value = selectedRating; updateStarsDisplay(selectedRating); }));
        function openRatingModal(orderId) { ratingOrderIdInput.value = orderId; selectedRating = 0; updateStarsDisplay(0); ratingModalOverlay.classList.add('active'); document.body.style.overflow = 'hidden'; }
        function closeRatingModalFunc() { ratingModalOverlay.classList.remove('active'); document.body.style.overflow = 'auto'; }
        closeRatingModal.addEventListener('click', closeRatingModalFunc);
        ratingModalOverlay.addEventListener('click', (e) => { if (e.target === ratingModalOverlay) closeRatingModalFunc(); });
        submitRatingBtn.addEventListener('click', () => {
            const orderId = ratingOrderIdInput.value;
            if (selectedRating === 0) { alert('Пожалуйста, выберите оценку'); return; }
            const idx = orders.findIndex(o => o.id === orderId);
            if (idx !== -1) { orders[idx].status = 'completed'; orders[idx].rating = selectedRating; orders[idx].completedAt = new Date().getTime(); saveOrdersToStorage(); renderOrders(); alert(`Спасибо за оценку: ${selectedRating} звезд!`); }
            closeRatingModalFunc();
        });

        // ========== ОФОРМЛЕНИЕ ЗАКАЗА ==========
        cartPageOrderBtn?.addEventListener('click', () => {
            if (cart.length === 0) return;
            orderModal.style.opacity = '1';
            orderModal.style.visibility = 'visible';
            document.body.style.overflow = 'hidden';
            orderForm.reset();
            orderForm.style.display = 'block';
            orderSuccess.style.display = 'none';
            deliveryAddressGroup.classList.remove('visible');
            deliveryAddressInput.removeAttribute('required');
            document.getElementById('pickup').checked = true;
            
            // Сбрасываем состояние бонусной карты (чекбокс и класс)
            useBonusCardInOrder.checked = false;
            bonusCardButton.classList.remove('active');
            
            if (bonusCard) {
                bonusBalanceDisplay.textContent = bonusCard.balance;
                const total = cart.reduce((s,i) => s + i.price * i.quantity, 0);
                if (total < 500) { 
                    bonusWarning.style.display = 'block'; 
                    bonusCardButton.classList.add('bonus-card-disabled'); 
                } else { 
                    bonusWarning.style.display = 'none'; 
                    bonusCardButton.classList.remove('bonus-card-disabled'); 
                }
            } else { 
                bonusCardButton.style.display = 'none'; 
                bonusBalanceInfo.style.display = 'none'; 
                bonusWarning.style.display = 'none'; 
            }
            bonusEarnedInfo.style.display = 'none'; 
            bonusSpentInfo.style.display = 'none';
        });
        
        // Обработчик клика по кнопке бонусной карты (переключение активного состояния)
        bonusCardButton.addEventListener('click', function() {
            if (!bonusCard) {
                alert('У вас нет активной бонусной карты. Активируйте её в разделе "Ещё"');
                return;
            }
            
            const total = cart.reduce((s,i) => s + i.price * i.quantity, 0);
            if (total < 500) {
                alert('Бонусную карту можно использовать только в заказах от 500 рублей');
                return;
            }
            
            // Переключаем класс active и чекбокс
            this.classList.toggle('active');
            useBonusCardInOrder.checked = this.classList.contains('active');
        });
        
        closeModal.addEventListener('click', () => { orderModal.style.opacity = '0'; orderModal.style.visibility = 'hidden'; document.body.style.overflow = 'auto'; });
        orderModal.addEventListener('click', (e) => { if (e.target === orderModal) { orderModal.style.opacity = '0'; orderModal.style.visibility = 'hidden'; document.body.style.overflow = 'auto'; } });
        deliveryTypeRadios.forEach(r => r.addEventListener('change', function() {
            if (this.value === 'delivery') { deliveryAddressGroup.classList.add('visible'); deliveryAddressInput.setAttribute('required', 'required'); } 
            else { deliveryAddressGroup.classList.remove('visible'); deliveryAddressInput.removeAttribute('required'); }
        }));
        orderForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('customerName').value;
            const email = document.getElementById('customerEmail').value;
            const delType = document.querySelector('input[name="deliveryType"]:checked').value;
            const addr = delType === 'delivery' ? document.getElementById('customerAddress').value : null;
            const useBonus = useBonusCardInOrder.checked;
            const total = cart.reduce((s,i) => s + i.price * i.quantity, 0);
            if (useBonus && total < 500) { alert('Бонусную карту можно использовать только в заказах от 500 рублей'); return; }
            const newOrder = createOrder({ name, email }, cart, delType, addr, useBonus);
            orderNumberElement.textContent = newOrder.id;
            if (newOrder.bonusUsed) {
                if (newOrder.bonusEarned > 0) { bonusEarned.textContent = newOrder.bonusEarned; bonusEarnedInfo.style.display = 'block'; }
                if (newOrder.bonusSpent > 0) { bonusSpent.textContent = newOrder.bonusSpent; bonusSpentInfo.style.display = 'block'; }
            }
            orderForm.style.display = 'none';
            orderSuccess.style.display = 'block';
            setTimeout(() => {
                cart = []; updateCart(); orderModal.style.opacity = '0'; orderModal.style.visibility = 'hidden'; document.body.style.overflow = 'auto';
                switchPage('home');
                setTimeout(() => { openMorePanel(); showOrdersInMore(); }, 300);
            }, 2000);
        });

        // ========== КНОПКА НАВЕРХ ==========
        window.addEventListener('scroll', () => scrollToTopBtn.classList.toggle('visible', window.scrollY > 300));
        scrollToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

        // ========== ОБРАБОТЧИК ДЛЯ ФУТЕРА (ГРАВИТАЦИЯ) ==========
        footer.addEventListener('click', applyGravityEffect);

        // ========== ЗАГРУЗКА ДАННЫХ ==========
        loadCartFromStorage();
        loadOrdersFromStorage();
        loadBonusCardFromStorage();
        updateBonusDisplay();
        setInterval(updateOrderStatuses, 60000);
        switchPage('home');

        // Обработчик для кнопок удаления/получения
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('received-btn') && e.target.id !== 'submitRating') {
                openRatingModal(e.target.dataset.orderId);
            }
            if (e.target.classList.contains('delete-order-btn')) {
                if (confirm('Удалить заказ?')) {
                    const idx = orders.findIndex(o => o.id === e.target.dataset.orderId);
                    if (idx !== -1) orders.splice(idx, 1);
                    saveOrdersToStorage();
                    renderOrders();
                }
            }
        });
    </script>
</body>
</html>